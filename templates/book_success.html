{% extends "base.html" %}
{% block title %}ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² â€” ÙˆØ¬Ù‡Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©{% endblock %}
{% block content %}
<section class="container" style="padding:22px 0">
  <h1 class="page-title">ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</h1>

  {% with msgs = get_flashed_messages(with_categories=true) %}
    {% if msgs %}
      <div class="flash">
        {% for cat, msg in msgs %}
          <p class="flash__msg {{cat}}">{{ msg }}</p>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  {% if paid %}
    <div class="card" style="padding:12px; margin:10px 0;">
      <p>âœ… ØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­ â€” Ø´ÙƒØ±Ù‹Ø§ Ù„Ùƒ!</p>
      <ul>
        <li>Ø§Ù„Ø±Ø­Ù„Ø©: {{ details.trip_title or (data.trip.title if data and data.trip else 'Ø±Ø­Ù„Ø©') }}</li>
        <li>Ø§Ù„Ø§Ø³Ù…: {{ details.name or (data.name if data else '') }}</li>
        <li>Ø§Ù„Ø¨Ø±ÙŠØ¯: {{ details.email or (data.email if data else '') }}</li>
        <li>Ø§Ù„ØªØ§Ø±ÙŠØ®: {{ details.date or (data.date if data else '') }}</li>
        <li>Ø§Ù„Ø£ÙŠØ§Ù…: {{ details.days or (data.days if data else '') }} | Ø§Ù„Ø£Ø´Ø®Ø§Øµ: {{ details.persons or (data.persons if data else '') }}</li>
        <li>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: {{ details.total_sar or (data.total_price if data else '') }} Ø±.Ø³</li>
      </ul>

      <div class="note" style="margin-top:10px">
        âœ… ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¢Ù†ØŒ ÙˆØ¸Ù‡Ø±Øª Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„.
      </div>
      <div class="card__actions" style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;">
        <a class="btn btn--primary" href="{{ url_for('invoice_pdf') }}">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© PDF</a>
        <a class="btn btn--ghost" href="{{ url_for('trips') }}">Ø­Ø¬Ø² Ø±Ø­Ù„Ø© Ø£Ø®Ø±Ù‰</a>
      </div>

      <div class="card" style="padding:12px;margin-top:12px">
        <h3 style="margin:0 0 8px;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø¯</h3>
        <ul style="margin:0;line-height:1.9">
          <li>ÙˆØ§ØªØ³Ø§Ø¨: <a href="https://wa.me/966500000000" target="_blank" rel="noopener">+966500000000</a></li>
          <li>Ø§ØªØµØ§Ù„: <a href="tel:+966500000000">+966500000000</a></li>
        </ul>
      </div>
    </div>
  {% else %}
    {% if data %}
      <div class="card" style="padding:16px;margin-top:10px">
        <p>Ø´ÙƒØ±Ù‹Ø§ <strong>{{ data.name }}</strong>ØŒ ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ ğŸ‘Œ</p>
        <ul style="line-height:1.9">
          <li>Ø§Ù„Ø±Ø­Ù„Ø©: <strong>{{ data.trip.title }}</strong> â€” {{ data.trip.city }}</li>
          <li>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…: <strong>{{ data.days }}</strong> | Ø§Ù„Ø£Ø´Ø®Ø§Øµ: <strong>{{ data.persons }}</strong></li>
          <li>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙŠÙˆÙ…ÙŠ: <strong>{{ data.trip.price_per_day }}</strong> Ø±.Ø³</li>
          <li>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <strong>{{ data.total_price }}</strong> Ø±.Ø³</li>
          <li class="muted">ÙˆÙ‚Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: {{ data.created_at }}</li>
        </ul>
        <div class="note" style="margin-top:10px">
          <strong>Ø®Ø·ÙˆØ© Ø£Ø®ÙŠØ±Ø©:</strong> Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§.
        </div>
        <form action="{{ url_for('pay_start') }}" method="post" style="margin-top:12px">
          <button class="btn btn--primary" type="submit">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¯ÙØ¹</button>
          <a class="btn btn--ghost" href="{{ url_for('trips') }}">Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø­Ù„Ø§Øª</a>
        </form>
      </div>
    {% else %}
      <p class="muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¬Ø² Ù„Ø¹Ø±Ø¶Ù‡.</p>
      <p><a class="btn btn--ghost" href="{{ url_for('booking') }}">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø­Ø¬Ø²</a></p>
    {% endif %}
  {% endif %}
</section>
{% endblock %}