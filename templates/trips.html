{% extends "base.html" %}
{% block title %}الرحلات{% endblock %}

{% block content %}
<section class="section">
  <div class="container">
    <h1 class="mt-0">كل الرحلات</h1>
    <p class="mb-3">اختر من بين باقاتنا المتنوعة عبر مدن المملكة</p>

    <!-- فلاتر واجهة (تعمل على الواجهة ويمكن لاحقًا تفعيلها سيرفر سايد) -->
    <form id="tripsFilters" class="form" style="margin-bottom:16px;">
      <div class="row">
        <div>
          <label class="label">المدينة</label>
          <select class="input" name="city" id="filterCity">
            <option value="">كل المدن</option>
            {% set _cities = trips | map(attribute='city') | list | unique %}
            {% for c in _cities %}
              <option value="{{ c }}">{{ c }}</option>
            {% endfor %}
          </select>
        </div>
        <div>
          <label class="label">السعر الأقصى ({{ currency }} / اليوم)</label>
          <input class="input" type="number" min="0" step="1" id="filterMaxPrice" placeholder="مثال: 400">
        </div>
      </div>
      <div class="row">
        <div>
          <label class="label">بحث بالاسم</label>
          <input class="input" type="text" id="filterQuery" placeholder="ابحث عن رحلة…">
        </div>
        <div style="display:flex;align-items:flex-end;gap:8px;">
          <button type="button" id="applyFilters" class="btn btn-primary">تطبيق</button>
          <button type="button" id="resetFilters" class="btn btn-ghost">إزالة الفلاتر</button>
        </div>
      </div>
    </form>

    {% if trips and trips|length %}
    <div id="tripsGrid" class="grid grid-3">
      {% for t in trips %}
      <article class="card trip-card"
               data-city="{{ t.city }}"
               data-price="{{ t.price }}"
               data-name="{{ t.name }}">
        <img src="{{ url_for('static', filename=t.image) }}" alt="{{ t.name }}">
        <div class="card-body">
          <h3 class="card-title">{{ t.name }}</h3>
          <p class="card-sub">{{ t.city }} • {{ t.days }} يوم</p>
          <p class="mb-2"><strong>{{ t.price }}</strong> {{ currency }} / اليوم</p>
          <p class="mb-3">{{ t.summary }}</p>
          <div class="card-actions">
            <a class="btn btn-ghost" href="{{ url_for('trip_details', trip_id=t.id) }}">عرض التفاصيل</a>
            <a class="btn btn-primary" href="{{ url_for('booking', trip_id=t.id) }}">احجز الآن</a>
          </div>
        </div>
      </article>
      {% endfor %}
    </div>
    {% else %}
      <div class="stat-card center">لا توجد رحلات متاحة حاليًا.</div>
    {% endif %}
  </div>
</section>
{% endblock %}