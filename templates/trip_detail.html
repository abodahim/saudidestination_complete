{% extends "base.html" %}
{% block title %}{{ trip.title }} — وجهة السعودية{% endblock %}
{# === ضع هذا بعد extends وقبل block content === #}
{% block head_extra %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Product",
    "name": "{{ trip.title|e }}",
    "description": "{{ trip.summary|e }}",
    "image": [
      {% for img in trip.images %}
        "{{ url_for('static', filename=img, _external=True) }}"{{ "," if not loop.last }}
      {% endfor %}
    ],
    "brand": {
      "@type": "Organization",
      "name": "وجهة السعودية"
    },
    "url": "{{ url_for('trip_detail', slug=trip.slug, _external=True) }}",
    "offers": {
      "@type": "Offer",
      "price": "{{ trip.price_per_day }}",
      "priceCurrency": "SAR",
      "availability": "https://schema.org/InStock",
      "url": "{{ url_for('trip_detail', slug=trip.slug, _external=True) }}",
      "eligibleRegion": "{{ trip.city|e }}",
      "itemCondition": "https://schema.org/NewCondition"
    }
  }
  </script>
{% endblock %}
{% block content %}
<section class="container">
  <nav class="breadcrumbs" style="display:flex;gap:6px;align-items:center;margin:8px 0 12px;">
    <a href="{{ url_for('home') }}">الرئيسية</a><span>›</span>
    <a href="{{ url_for('trips') }}">الرحلات</a><span>›</span>
    <span class="muted">{{ trip.title }}</span>
  </nav>

  <header class="page-head" style="margin:6px 0 12px;">
    <h1 class="page-title" style="margin:0 0 4px;">{{ trip.title }}</h1>
    <p class="muted" style="margin:0;">المدينة: {{ trip.city }}</p>
  </header>

  <div class="cards" style="margin-top:10px;">
    {% for img in trip.images %}
    <article class="card">
      <img class="card__img"
        src="{{ url_for('static', filename=img) }}"
        alt="{{ trip.title }}"
        loading="lazy" decoding="async" width="960" height="640">
    </article>
    {% endfor %}
  </div>

  <div class="card" style="padding:16px; margin-top:16px;">
    <p style="margin:0 0 8px;">{{ trip.summary }}</p>
    <p class="muted" style="margin:0 0 12px;">
      السعر لليوم: <strong>{{ trip.price_per_day }} ر.س</strong>
      — الأيام المقترحة: <strong>{{ trip.days_default }}</strong>
    </p>
    <div class="card__actions" style="display:flex;gap:10px;flex-wrap:wrap;">
      <a class="btn btn--ghost" href="{{ url_for('trips') }}">عودة للرحلات</a>
      <a class="btn btn--primary" href="{{ url_for('booking', trip=trip.slug) }}">احجز هذه الرحلة</a>
    </div>
  </div>
</section>
{% if session.paid %}
  <a class="btn btn--ghost" href="{{ url_for('invoice_pdf') }}">📄 تحميل الفاتورة</a>
{% endif %}
{% endblock %}